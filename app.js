// Language translations
const translations = {
  id: {
    // Navigation
    logo: "Empal Gentong Emak",
    "nav-home": "Beranda",
    "nav-menu": "Menu",
    "nav-about": "Tentang",

    // Hero Section
    "hero-title": "Empal Gentong Emak",
    "hero-subtitle": "Cita Rasa Autentik Cirebon yang Tak Terlupakan",
    "hero-description":
      "Nikmati kelezatan empal gentong tradisional dengan resep turun temurun yang telah dipercaya selama puluhan tahun",
    "hero-cta": "Lihat Menu",

    // Features
    "features-title": "Mengapa Memilih Kami?",
    "feature1-title": "Resep Tradisional",
    "feature1-desc": "Menggunakan resep turun temurun yang autentik dari Cirebon",
    "feature2-title": "Bahan Segar",
    "feature2-desc": "Menggunakan bahan-bahan segar pilihan setiap hari",
    "feature3-title": "Chef Berpengalaman",
    "feature3-desc": "Dimasak oleh chef berpengalaman lebih dari 20 tahun",

    // Popular Menu
    "popular-title": "Menu Populer",
    "menu1-name": "Empal Gentong",
    "menu1-desc": "Sup daging sapi dengan kuah santan yang kaya rempah",
    "menu2-name": "Nasi Jamblang",
    "menu2-desc": "Nasi dengan berbagai lauk khas Cirebon",
    "menu3-name": "Tahu Gejrot",
    "menu3-desc": "Tahu goreng dengan kuah asam manis pedas",

    // Menu Page
    "menu-header-title": "Menu Kami",
    "menu-header-desc": "Pilihan makanan khas Cirebon yang lezat dan autentik",
    "main-dishes-title": "Makanan Utama",
    "snacks-title": "Camilan",
    "beverages-title": "Minuman",

    // Menu Items
    "item1-name": "Empal Gentong",
    "item1-desc": "Sup daging sapi dengan kuah santan yang kaya rempah, disajikan dengan nasi putih",
    "item2-name": "Nasi Jamblang",
    "item2-desc": "Nasi dengan berbagai lauk khas Cirebon seperti empal, tahu, tempe, dan sayuran",
    "item3-name": "Sate Kalong",
    "item3-desc": "Sate daging sapi khas Cirebon dengan bumbu kacang yang gurih",
    "item4-name": "Tahu Gejrot",
    "item4-desc": "Tahu goreng dengan kuah asam manis pedas yang menyegarkan",
    "item5-name": "Kerupuk Melarat",
    "item5-desc": "Kerupuk khas Cirebon yang renyah dengan taburan bumbu",
    "item6-name": "Docang",
    "item6-desc": "Lontong dengan sayur dan kerupuk dalam kuah santan gurih",
    "item7-name": "Es Teh Manis",
    "item7-desc": "Teh manis dingin yang menyegarkan",
    "item8-name": "Es Jeruk",
    "item8-desc": "Jus jeruk segar dengan es batu",
    "item9-name": "Kopi Tubruk",
    "item9-desc": "Kopi tradisional Indonesia yang kental dan nikmat",

    // About Page
    "about-header-title": "Tentang Kami",
    "about-header-desc": "Cerita di balik kelezatan Empal Gentong Emak",
    "story-title": "Cerita Kami",
    "story-p1":
      "Empal Gentong Emak didirikan pada tahun 1957 oleh Ibu Siti Aminah, seorang ibu rumah tangga yang memiliki passion besar terhadap kuliner tradisional Cirebon. Berawal dari warung kecil di pinggir jalan, kini Empal Gentong Emak telah menjadi salah satu destinasi kuliner favorit di Cirebon.",
    "story-p2":
      "Resep empal gentong yang kami gunakan merupakan warisan turun temurun dari nenek moyang yang telah dipertahankan keasliannya selama puluhan tahun. Setiap mangkuk empal gentong yang kami sajikan dibuat dengan penuh cinta dan dedikasi untuk memberikan pengalaman kuliner yang tak terlupakan.",
    "story-p3":
      "Kami bangga menjadi bagian dari pelestarian kuliner tradisional Cirebon dan berkomitmen untuk terus menyajikan cita rasa autentik yang telah dipercaya oleh ribuan pelanggan setia.",

    // Values
    "values-title": "Nilai-Nilai Kami",
    "value1-title": "Tradisi",
    "value1-desc": "Mempertahankan resep dan cara memasak tradisional yang autentik",
    "value2-title": "Kualitas",
    "value2-desc": "Menggunakan bahan-bahan terbaik dan proses memasak yang teliti",
    "value3-title": "Pelayanan",
    "value3-desc": "Memberikan pelayanan terbaik dengan keramahan khas Cirebon",
    "value4-title": "Keberlanjutan",
    "value4-desc": "Mendukung petani lokal dan menjaga kelestarian lingkungan",

    // Team
    "team-title": "Tim Kami",
    "team1-name": "Ibu Siti Aminah",
    "team1-role": "Pendiri & Head Chef",
    "team1-desc": "Penjaga resep tradisional dan jiwa dari Empal Gentong Emak",
    "team2-name": "Bapak Ahmad",
    "team2-role": "Manager Operasional",
    "team2-desc": "Memastikan kualitas dan pelayanan terbaik setiap hari",
    "team3-name": "Mbak Rina",
    "team3-role": "Sous Chef",
    "team3-desc": "Ahli dalam mempersiapkan bumbu dan rempah-rempah",

    // Contact
    "contact-title": "Hubungi Kami",
    "contact-address-title": "Alamat",
    "contact-phone-title": "Telepon",
    "contact-email-title": "Email",
    "contact-hours-title": "Jam Buka",
    "contact-hours-text": "Senin - Minggu: 08:00 - 22:00",

    // Footer
    "footer-desc": "Menyajikan cita rasa autentik Cirebon sejak 1957",
    "footer-contact": "Kontak",
    "footer-hours": "Jam Buka",
    "footer-hours-text": "Senin - Minggu: 08:00 - 22:00",

    // Loading
    "loading-text": "Memuat...",
  },
  en: {
    // Navigation
    logo: "Empal Gentong Emak",
    "nav-home": "Home",
    "nav-menu": "Menu",
    "nav-about": "About",

    // Hero Section
    "hero-title": "Empal Gentong Emak",
    "hero-subtitle": "Unforgettable Authentic Cirebon Flavors",
    "hero-description":
      "Enjoy the deliciousness of traditional empal gentong with ancestral recipes that have been trusted for decades",
    "hero-cta": "View Menu",

    // Features
    "features-title": "Why Choose Us?",
    "feature1-title": "Traditional Recipe",
    "feature1-desc": "Using authentic ancestral recipes from Cirebon",
    "feature2-title": "Fresh Ingredients",
    "feature2-desc": "Using the finest fresh ingredients every day",
    "feature3-title": "Experienced Chef",
    "feature3-desc": "Cooked by chefs with more than 20 years of experience",

    // Popular Menu
    "popular-title": "Popular Menu",
    "menu1-name": "Empal Gentong",
    "menu1-desc": "Beef soup with rich spiced coconut milk broth",
    "menu2-name": "Nasi Jamblang",
    "menu2-desc": "Rice with various traditional Cirebon side dishes",
    "menu3-name": "Tahu Gejrot",
    "menu3-desc": "Fried tofu with sweet and sour spicy sauce",

    // Menu Page
    "menu-header-title": "Our Menu",
    "menu-header-desc": "Delicious and authentic Cirebon food choices",
    "main-dishes-title": "Main Dishes",
    "snacks-title": "Snacks",
    "beverages-title": "Beverages",

    // Menu Items
    "item1-name": "Empal Gentong",
    "item1-desc": "Beef soup with rich spiced coconut milk broth, served with white rice",
    "item2-name": "Nasi Jamblang",
    "item2-desc": "Rice with various Cirebon specialties like empal, tofu, tempeh, and vegetables",
    "item3-name": "Sate Kalong",
    "item3-desc": "Cirebon-style beef satay with savory peanut sauce",
    "item4-name": "Tahu Gejrot",
    "item4-desc": "Fried tofu with refreshing sweet and sour spicy sauce",
    "item5-name": "Kerupuk Melarat",
    "item5-desc": "Crispy Cirebon crackers with spice sprinkles",
    "item6-name": "Docang",
    "item6-desc": "Rice cake with vegetables and crackers in savory coconut milk broth",
    "item7-name": "Sweet Iced Tea",
    "item7-desc": "Refreshing cold sweet tea",
    "item8-name": "Orange Juice",
    "item8-desc": "Fresh orange juice with ice cubes",
    "item9-name": "Tubruk Coffee",
    "item9-desc": "Traditional Indonesian coffee that is thick and delicious",

    // About Page
    "about-header-title": "About Us",
    "about-header-desc": "The story behind the deliciousness of Empal Gentong Emak",
    "story-title": "Our Story",
    "story-p1":
      "Empal Gentong Emak was founded in 1957 by Mrs. Siti Aminah, a housewife who has a great passion for traditional Cirebon cuisine. Starting from a small roadside stall, Empal Gentong Emak has now become one of the favorite culinary destinations in Cirebon.",
    "story-p2":
      "The empal gentong recipe we use is an ancestral heritage that has been maintained for decades. Every bowl of empal gentong we serve is made with love and dedication to provide an unforgettable culinary experience.",
    "story-p3":
      "We are proud to be part of preserving traditional Cirebon cuisine and are committed to continuing to serve authentic flavors that have been trusted by thousands of loyal customers.",

    // Values
    "values-title": "Our Values",
    "value1-title": "Tradition",
    "value1-desc": "Maintaining authentic traditional recipes and cooking methods",
    "value2-title": "Quality",
    "value2-desc": "Using the best ingredients and careful cooking processes",
    "value3-title": "Service",
    "value3-desc": "Providing the best service with typical Cirebon friendliness",
    "value4-title": "Sustainability",
    "value4-desc": "Supporting local farmers and maintaining environmental sustainability",

    // Team
    "team-title": "Our Team",
    "team1-name": "Mrs. Siti Aminah",
    "team1-role": "Founder & Head Chef",
    "team1-desc": "Guardian of traditional recipes and soul of Empal Gentong Emak",
    "team2-name": "Mr. Ahmad",
    "team2-role": "Operations Manager",
    "team2-desc": "Ensuring the best quality and service every day",
    "team3-name": "Ms. Rina",
    "team3-role": "Sous Chef",
    "team3-desc": "Expert in preparing spices and seasonings",

    // Contact
    "contact-title": "Contact Us",
    "contact-address-title": "Address",
    "contact-phone-title": "Phone",
    "contact-email-title": "Email",
    "contact-hours-title": "Opening Hours",
    "contact-hours-text": "Monday - Sunday: 08:00 - 22:00",

    // Footer
    "footer-desc": "Serving authentic Cirebon flavors since 1957",
    "footer-contact": "Contact",
    "footer-hours": "Opening Hours",
    "footer-hours-text": "Monday - Sunday: 08:00 - 22:00",

    // Loading
    "loading-text": "Loading...",
  },
}

// Page Templates
const pages = {
  home: () => `
    <!-- Hero Section -->
    <section class="hero">
      <div class="hero-content">
        <h1 data-id="hero-title">Empal Gentong Emak</h1>
        <p data-id="hero-subtitle">
          Cita Rasa Autentik Cirebon yang Tak Terlupakan
        </p>
        <p data-id="hero-description">
          Nikmati kelezatan empal gentong tradisional dengan resep turun temurun
          yang telah dipercaya selama puluhan tahun
        </p>
        <a href="#menu" class="cta-button nav-link" data-id="hero-cta">Lihat Menu</a>
      </div>
      <div class="hero-image">
        <img src="items/images/image.png" alt="Empal Gentong" />
      </div>
    </section>

    <!-- Features Section -->
    <section class="features">
      <div class="container">
        <h2 data-id="features-title">Mengapa Memilih Kami?</h2>
        <div class="features-grid">
          <div class="feature-card">
            <div class="feature-icon">ğŸ²</div>
            <h3 data-id="feature1-title">Resep Tradisional</h3>
            <p data-id="feature1-desc">
              Menggunakan resep turun temurun yang autentik dari Cirebon
            </p>
          </div>
          <div class="feature-card">
            <div class="feature-icon">ğŸŒ¿</div>
            <h3 data-id="feature2-title">Bahan Segar</h3>
            <p data-id="feature2-desc">
              Menggunakan bahan-bahan segar pilihan setiap hari
            </p>
          </div>
          <div class="feature-card">
            <div class="feature-icon">ğŸ‘¨â€ğŸ³</div>
            <h3 data-id="feature3-title">Chef Berpengalaman</h3>
            <p data-id="feature3-desc">
              Dimasak oleh chef berpengalaman lebih dari 20 tahun
            </p>
          </div>
        </div>
      </div>
    </section>

    <!-- Popular Menu Section -->
    <section class="popular-menu">
      <div class="container">
        <h2 data-id="popular-title">Menu Populer</h2>
        <div class="menu-grid">
          <div class="menu-card">
            <img
              src="items/images/image.png"
              alt="Empal Gentong"
            />
            <div class="menu-info">
              <h3 data-id="menu1-name">Empal Gentong</h3>
              <p data-id="menu1-desc">
                Sup daging sapi dengan kuah santan yang kaya rempah
              </p>
              <span class="price">Rp 25.000</span>
            </div>
          </div>
          <div class="menu-card">
            <img
              src="items/images/jamblang.jpeg"
              alt="Nasi Jamblang"
            />
            <div class="menu-info">
              <h3 data-id="menu2-name">Nasi Jamblang</h3>
              <p data-id="menu2-desc">Nasi dengan berbagai lauk khas Cirebon</p>
              <span class="price">Rp 20.000</span>
            </div>
          </div>
          <div class="menu-card">
            <img
              src="items/images/tahu-gejrot.jpeg"
              alt="Tahu Gejrot"
            />
            <div class="menu-info">
              <h3 data-id="menu3-name">Tahu Gejrot</h3>
              <p data-id="menu3-desc">
                Tahu goreng dengan kuah asam manis pedas
              </p>
              <span class="price">Rp 15.000</span>
            </div>
          </div>
        </div>
      </div>
    </section>
  `,

  menu: () => `
    <!-- Menu Header -->
    <section class="page-header">
      <div class="container">
        <h1 data-id="menu-header-title">Menu Kami</h1>
        <p data-id="menu-header-desc">
          Pilihan makanan khas Cirebon yang lezat dan autentik
        </p>
      </div>
    </section>

    <!-- Menu Categories -->
    <section class="menu-section">
      <div class="container">
        <!-- Main Dishes -->
        <div class="menu-category">
          <h2 data-id="main-dishes-title">Makanan Utama</h2>
          <div class="menu-items">
            <div class="menu-item">
              <img src="items/images/image.png" alt="Empal Gentong" />
              <div class="item-info">
                <h3 data-id="item1-name">Empal Gentong</h3>
                <p data-id="item1-desc">
                  Sup daging sapi dengan kuah santan yang kaya rempah, disajikan
                  dengan nasi putih
                </p>
                <span class="price">Rp 25.000</span>
              </div>
            </div>
            <div class="menu-item">
              <img src="items/images/jamblang.jpeg" alt="Nasi Jamblang" />
              <div class="item-info">
                <h3 data-id="item2-name">Nasi Jamblang</h3>
                <p data-id="item2-desc">
                  Nasi dengan berbagai lauk khas Cirebon seperti empal, tahu,
                  tempe, dan sayuran
                </p>
                <span class="price">Rp 20.000</span>
              </div>
            </div>
            <div class="menu-item">
              <img src="items/images/sate.jpeg" alt="Sate Kalong" />
              <div class="item-info">
                <h3 data-id="item3-name">Sate Kalong</h3>
                <p data-id="item3-desc">
                  Sate daging sapi khas Cirebon dengan bumbu kacang yang gurih
                </p>
                <span class="price">Rp 30.000</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Snacks -->
        <div class="menu-category">
          <h2 data-id="snacks-title">Camilan</h2>
          <div class="menu-items">
            <div class="menu-item">
              <img src="items/images/tahu-gejrot.jpeg" alt="Tahu Gejrot" />
              <div class="item-info">
                <h3 data-id="item4-name">Tahu Gejrot</h3>
                <p data-id="item4-desc">
                  Tahu goreng dengan kuah asam manis pedas yang menyegarkan
                </p>
                <span class="price">Rp 15.000</span>
              </div>
            </div>
            <div class="menu-item">
              <img
                src="items/images/kerupuk-melarat.jpeg"
                alt="Kerupuk Melarat"
              />
              <div class="item-info">
                <h3 data-id="item5-name">Kerupuk Melarat</h3>
                <p data-id="item5-desc">
                  Kerupuk khas Cirebon yang renyah dengan taburan bumbu
                </p>
                <span class="price">Rp 10.000</span>
              </div>
            </div>
            <div class="menu-item">
              <img src="items/images/docang.jpeg" alt="Docang" />
              <div class="item-info">
                <h3 data-id="item6-name">Docang</h3>
                <p data-id="item6-desc">
                  Lontong dengan sayur dan kerupuk dalam kuah santan gurih
                </p>
                <span class="price">Rp 18.000</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Beverages -->
        <div class="menu-category">
          <h2 data-id="beverages-title">Minuman</h2>
          <div class="menu-items">
            <div class="menu-item">
              <img src="items/images/es-teh.jpeg" alt="Es Teh Manis" />
              <div class="item-info">
                <h3 data-id="item7-name">Es Teh Manis</h3>
                <p data-id="item7-desc">Teh manis dingin yang menyegarkan</p>
                <span class="price">Rp 5.000</span>
              </div>
            </div>
            <div class="menu-item">
              <img src="items/images/es-jeruk.jpeg" alt="Es Jeruk" />
              <div class="item-info">
                <h3 data-id="item8-name">Es Jeruk</h3>
                <p data-id="item8-desc">Jus jeruk segar dengan es batu</p>
                <span class="price">Rp 8.000</span>
              </div>
            </div>
            <div class="menu-item">
              <img src="items/images/kopi-tubruk.jpeg" alt="Kopi Tubruk" />
              <div class="item-info">
                <h3 data-id="item9-name">Kopi Tubruk</h3>
                <p data-id="item9-desc">
                  Kopi tradisional Indonesia yang kental dan nikmat
                </p>
                <span class="price">Rp 7.000</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  `,

  about: () => `
    <!-- About Header -->
    <section class="page-header">
      <div class="container">
        <h1 data-id="about-header-title">Tentang Kami</h1>
        <p data-id="about-header-desc">
          Cerita di balik kelezatan Empal Gentong Emak
        </p>
      </div>
    </section>

    <!-- About Content -->
    <section class="about-content">
      <div class="container">
        <div class="about-story">
          <div class="story-text">
            <h2 data-id="story-title">Cerita Kami</h2>
            <p data-id="story-p1">
              Empal Gentong Emak didirikan pada tahun 1957 oleh Ibu Siti Aminah,
              seorang ibu rumah tangga yang memiliki passion besar terhadap
              kuliner tradisional Cirebon. Berawal dari warung kecil di pinggir
              jalan, kini Empal Gentong Emak telah menjadi salah satu destinasi
              kuliner favorit di Cirebon.
            </p>

            <p data-id="story-p2">
              Resep empal gentong yang kami gunakan merupakan warisan turun
              temurun dari nenek moyang yang telah dipertahankan keasliannya
              selama puluhan tahun. Setiap mangkuk empal gentong yang kami
              sajikan dibuat dengan penuh cinta dan dedikasi untuk memberikan
              pengalaman kuliner yang tak terlupakan.
            </p>

            <p data-id="story-p3">
              Kami bangga menjadi bagian dari pelestarian kuliner tradisional
              Cirebon dan berkomitmen untuk terus menyajikan cita rasa autentik
              yang telah dipercaya oleh ribuan pelanggan setia.
            </p>
          </div>
          <div class="story-image">
            <img
              src="items/images/lama.jpg"
              alt="Sejarah Empal Gentong Emak"
            />
          </div>
        </div>
      </div>
    </section>

    <!-- Values Section -->
    <section class="values-section">
      <div class="container">
        <h2 data-id="values-title">Nilai-Nilai Kami</h2>
        <div class="values-grid">
          <div class="value-card">
            <div class="value-icon">ğŸ›ï¸</div>
            <h3 data-id="value1-title">Tradisi</h3>
            <p data-id="value1-desc">
              Mempertahankan resep dan cara memasak tradisional yang autentik
            </p>
          </div>
          <div class="value-card">
            <div class="value-icon">â¤ï¸</div>
            <h3 data-id="value2-title">Kualitas</h3>
            <p data-id="value2-desc">
              Menggunakan bahan-bahan terbaik dan proses memasak yang teliti
            </p>
          </div>
          <div class="value-card">
            <div class="value-icon">ğŸ¤</div>
            <h3 data-id="value3-title">Pelayanan</h3>
            <p data-id="value3-desc">
              Memberikan pelayanan terbaik dengan keramahan khas Cirebon
            </p>
          </div>
          <div class="value-card">
            <div class="value-icon">ğŸŒ±</div>
            <h3 data-id="value4-title">Keberlanjutan</h3>
            <p data-id="value4-desc">
              Mendukung petani lokal dan menjaga kelestarian lingkungan
            </p>
          </div>
        </div>
      </div>
    </section>

    <!-- Team Section -->
    <section class="team-section">
      <div class="container">
        <h2 data-id="team-title">Tim Kami</h2>
        <div class="team-grid">
          <div class="team-member">
            <img src="items/images/ibu-siti.jpg" alt="Ibu Siti Aminah" />
            <h3 data-id="team1-name">Ibu Siti Aminah</h3>
            <p data-id="team1-role">Pendiri & Head Chef</p>
            <p data-id="team1-desc">
              Penjaga resep tradisional dan jiwa dari Empal Gentong Emak
            </p>
          </div>
          <div class="team-member">
            <img src="items/images/ahmad.jpg" alt="Bapak Ahmad" />
            <h3 data-id="team2-name">Bapak Ahmad</h3>
            <p data-id="team2-role">Manager Operasional</p>
            <p data-id="team2-desc">
              Memastikan kualitas dan pelayanan terbaik setiap hari
            </p>
          </div>
          <div class="team-member">
            <img src="items/images/rina.jpg" alt="Mbak Rina" />
            <h3 data-id="team3-name">Mbak Rina</h3>
            <p data-id="team3-role">Sous Chef</p>
            <p data-id="team3-desc">
              Ahli dalam mempersiapkan bumbu dan rempah-rempah
            </p>
          </div>
        </div>
      </div>
    </section>

    <!-- Contact Section -->
    <section class="contact-section">
      <div class="container">
        <h2 data-id="contact-title">Hubungi Kami</h2>
        <div class="contact-info">
          <div class="contact-item">
            <div class="contact-icon">ğŸ“</div>
            <div>
              <h4 data-id="contact-address-title">Alamat</h4>
              <p>
                Jl. Sunan Kalijaga No. 123, Kejaksan, Cirebon, Jawa Barat 45121
              </p>
            </div>
          </div>
          <div class="contact-item">
            <div class="contact-icon">ğŸ“</div>
            <div>
              <h4 data-id="contact-phone-title">Telepon</h4>
              <p>+62 123-4567-8910</p>
            </div>
          </div>
          <div class="contact-item">
            <div class="contact-icon">ğŸ•’</div>
            <div>
              <h4 data-id="contact-hours-title">Jam Buka</h4>
              <p data-id="contact-hours-text">Senin - Minggu: 08:00 - 22:00</p>
            </div>
          </div>
        </div>
      </div>
    </section>
  `,
}

// Router Class
class Router {
  constructor() {
    this.routes = {}
    this.currentRoute = ""
    this.app = document.getElementById("app")
    this.isLoading = false
  }

  addRoute(path, handler) {
    this.routes[path] = handler
  }

  navigate(path) {
    if (this.isLoading) return

    // Update URL without page reload
    window.history.pushState({}, "", `#${path}`)
    this.loadRoute(path)
  }

  loadRoute(path) {
    if (this.isLoading) return

    this.isLoading = true
    this.showLoading()

    // Update active nav link
    this.updateActiveNav(path)

    setTimeout(() => {
      if (this.routes[path]) {
        this.app.innerHTML = this.routes[path]()
        this.currentRoute = path

        // Update page title
        this.updatePageTitle(path)

        // Re-apply translations
        updateLanguage(currentLang)

        // Re-initialize animations
        this.initializeAnimations()

        // Scroll to top
        window.scrollTo({ top: 0, behavior: "smooth" })
      }

      this.hideLoading()
      this.isLoading = false
    }, 800)
  }

  updateActiveNav(path) {
    // Remove active class from all nav links
    document.querySelectorAll(".nav-link").forEach((link) => {
      link.classList.remove("active")
    })

    // Add active class to current nav link
    const activeLink = document.querySelector(`a[href="#${path}"]`)
    if (activeLink) {
      activeLink.classList.add("active")
    }
  }

  updatePageTitle(path) {
    const titles = {
      home: "Empal Gentong Emak - Makanan Khas Cirebon",
      menu: "Menu - Empal Gentong Emak",
      about: "Tentang Kami - Empal Gentong Emak",
    }

    document.title = titles[path] || titles.home
  }

  showLoading() {
    const loadingOverlay = this.createLoadingScreen()
    document.body.appendChild(loadingOverlay)

    // Force reflow
    loadingOverlay.offsetHeight

    setTimeout(() => {
      loadingOverlay.classList.add("show")
    }, 10)
  }

  hideLoading() {
    const loadingScreen = document.getElementById("loadingScreen")
    if (loadingScreen) {
      loadingScreen.classList.add("fade-out")
      setTimeout(() => {
        if (loadingScreen.parentNode) {
          loadingScreen.remove()
        }
      }, 500)
    }
  }

  createLoadingScreen() {
    const loadingOverlay = document.createElement("div")
    loadingOverlay.id = "loadingScreen"
    loadingOverlay.className = "loading-overlay"
    loadingOverlay.innerHTML = `
      <div class="loading-container">
        <div class="loading-logo">
          <img src="items/images/logo.png" alt="Empal Gentong Emak" class="loading-logo-img">
          <div class="loading-pulse"></div>
        </div>
        <div class="loading-text" data-id="loading-text">Memuat...</div>
        <div class="loading-bar">
          <div class="loading-progress"></div>
        </div>
      </div>
    `

    return loadingOverlay
  }

  initializeAnimations() {
    // Re-observe elements for animation
    const observer = new IntersectionObserver(
      (entries) => {
        entries.forEach((entry) => {
          if (entry.isIntersecting) {
            entry.target.classList.add("loaded")
          }
        })
      },
      { threshold: 0.1, rootMargin: "0px 0px -50px 0px" },
    )

    document.querySelectorAll(".feature-card, .menu-card, .value-card, .team-member, .menu-item").forEach((el) => {
      el.classList.add("loading")
      observer.observe(el)

      // Add staggered animation
      setTimeout(() => {
        el.classList.add("loaded")
      }, Math.random() * 300)
    })
  }

  init() {
    // Set up routes
    this.addRoute("home", pages.home)
    this.addRoute("menu", pages.menu)
    this.addRoute("about", pages.about)

    // Handle browser back/forward
    window.addEventListener("popstate", () => {
      const path = window.location.hash.slice(1) || "home"
      this.loadRoute(path)
    })

    // Handle navigation clicks
    document.addEventListener("click", (e) => {
      if (e.target.classList.contains("nav-link")) {
        e.preventDefault()
        const path = e.target.getAttribute("href").slice(1)
        this.navigate(path)

        // Close mobile menu if open
        const hamburger = document.querySelector(".hamburger")
        const navMenu = document.querySelector(".nav-menu")
        if (hamburger && navMenu) {
          hamburger.classList.remove("active")
          navMenu.classList.remove("active")
          document.body.style.overflow = "auto"
        }
      }
    })

    // Load initial route
    const initialPath = window.location.hash.slice(1) || "home"
    this.loadRoute(initialPath)
  }
}

// App State
let currentLang = "id"
let router

// DOM elements
const themeToggle = document.getElementById("themeToggle")
const langToggle = document.getElementById("langToggle")
const musicToggle = document.getElementById("musicToggle")
const backToTop = document.getElementById("backToTop")
const backgroundMusic = document.getElementById("backgroundMusic")
const hamburger = document.querySelector(".hamburger")
const navMenu = document.querySelector(".nav-menu")

// Initialize App
document.addEventListener("DOMContentLoaded", () => {
  // Initialize router
  router = new Router()
  router.init()

  // Load saved theme and language
  const savedTheme = localStorage.getItem("theme") || "light"
  const savedLang = localStorage.getItem("language") || "id"

  setTheme(savedTheme)
  setLanguage(savedLang)

  // Initialize music state
  initializeMusicState()

  // Initialize music
  if (backgroundMusic) {
    backgroundMusic.volume = 0.3
  }

  // Add loading styles
  addLoadingStyles()
})

// Theme Management
function setTheme(theme) {
  document.documentElement.setAttribute("data-theme", theme)
  themeToggle.textContent = theme === "dark" ? "â˜€ï¸" : "ğŸŒ™"
  localStorage.setItem("theme", theme)
}

themeToggle.addEventListener("click", () => {
  const currentTheme = document.documentElement.getAttribute("data-theme")
  const newTheme = currentTheme === "dark" ? "light" : "dark"
  setTheme(newTheme)
})

// Language Management
function setLanguage(lang) {
  currentLang = lang
  langToggle.textContent = lang === "id" ? "ID" : "EN"
  document.documentElement.setAttribute("lang", lang)
  updateLanguage(lang)
  localStorage.setItem("language", lang)
}

function updateLanguage(lang) {
  const elements = document.querySelectorAll("[data-id]")
  elements.forEach((element) => {
    const key = element.getAttribute("data-id")
    if (translations[lang] && translations[lang][key]) {
      if (element.tagName === "INPUT" || element.tagName === "TEXTAREA") {
        element.placeholder = translations[lang][key]
      } else {
        element.textContent = translations[lang][key]
      }
    }
  })
}

langToggle.addEventListener("click", () => {
  const newLang = currentLang === "id" ? "en" : "id"
  setLanguage(newLang)
})

// Music Management
let isPlaying = false
let currentTime = 0
let musicVolume = 0.3

function initializeMusicState() {
  const savedMusicState = localStorage.getItem("musicState")
  const savedMusicTime = localStorage.getItem("musicTime")
  const savedMusicVolume = localStorage.getItem("musicVolume")

  if (savedMusicState === "playing") {
    isPlaying = true
    musicToggle.classList.add("playing")
    musicToggle.textContent = "ğŸ¶"
  }

  if (savedMusicTime) {
    currentTime = Number.parseFloat(savedMusicTime)
  }

  if (savedMusicVolume) {
    musicVolume = Number.parseFloat(savedMusicVolume)
  }

  if (backgroundMusic) {
    backgroundMusic.volume = musicVolume
    backgroundMusic.currentTime = currentTime

    if (isPlaying) {
      setTimeout(() => {
        backgroundMusic.play().catch((e) => {
          console.log("Auto-play failed:", e)
          isPlaying = false
          musicToggle.classList.remove("playing")
          musicToggle.textContent = "ğŸµ"
          localStorage.setItem("musicState", "paused")
        })
      }, 100)
    }
  }
}

function saveMusicState() {
  if (backgroundMusic && !backgroundMusic.paused) {
    localStorage.setItem("musicTime", backgroundMusic.currentTime.toString())
    localStorage.setItem("musicVolume", backgroundMusic.volume.toString())
  }
}

musicToggle.addEventListener("click", () => {
  if (backgroundMusic) {
    if (isPlaying) {
      backgroundMusic.pause()
      musicToggle.classList.remove("playing")
      musicToggle.textContent = "ğŸµ"
      localStorage.setItem("musicState", "paused")
      localStorage.setItem("musicTime", backgroundMusic.currentTime.toString())
    } else {
      backgroundMusic.play().catch((e) => {
        console.log("Audio play failed:", e)
      })
      musicToggle.classList.add("playing")
      musicToggle.textContent = "ğŸ¶"
      localStorage.setItem("musicState", "playing")
    }
    isPlaying = !isPlaying
  }
})

// Save music time periodically
setInterval(() => {
  if (backgroundMusic && !backgroundMusic.paused) {
    saveMusicState()
  }
}, 1000)

window.addEventListener("beforeunload", () => {
  saveMusicState()
})

if (backgroundMusic) {
  backgroundMusic.addEventListener("ended", () => {
    backgroundMusic.currentTime = 0
    if (isPlaying) {
      backgroundMusic.play()
    }
  })

  backgroundMusic.addEventListener("timeupdate", () => {
    currentTime = backgroundMusic.currentTime
  })
}

// Back to Top
window.addEventListener("scroll", () => {
  if (window.pageYOffset > 300) {
    backToTop.classList.add("visible")
  } else {
    backToTop.classList.remove("visible")
  }
})

backToTop.addEventListener("click", () => {
  window.scrollTo({
    top: 0,
    behavior: "smooth",
  })
})

// Mobile Menu
hamburger.addEventListener("click", (e) => {
  e.stopPropagation()
  hamburger.classList.toggle("active")
  navMenu.classList.toggle("active")

  if (navMenu.classList.contains("active")) {
    document.body.style.overflow = "hidden"
  } else {
    document.body.style.overflow = "auto"
  }
})

document.addEventListener("click", (e) => {
  if (!navMenu.contains(e.target) && !hamburger.contains(e.target)) {
    hamburger.classList.remove("active")
    navMenu.classList.remove("active")
    document.body.style.overflow = "auto"
  }
})

window.addEventListener("resize", () => {
  if (window.innerWidth > 768) {
    hamburger.classList.remove("active")
    navMenu.classList.remove("active")
    document.body.style.overflow = "auto"
  }
})

// Add Loading Styles
function addLoadingStyles() {
  const style = document.createElement("style")
  style.textContent = `
    .loading-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 9999;
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--loading-bg);
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
    }

    .loading-overlay.show {
      opacity: 1;
      visibility: visible;
    }

    .loading-overlay.fade-out {
      opacity: 0;
      visibility: hidden;
    }

    [data-theme="light"] .loading-overlay {
      --loading-bg: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
      --loading-text-color: #333;
      --loading-accent: #8b4513;
    }

    [data-theme="dark"] .loading-overlay {
      --loading-bg: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
      --loading-text-color: #ffffff;
      --loading-accent: #8b4513;
    }

    .loading-container {
      text-align: center;
      max-width: 300px;
      width: 90%;
    }

    .loading-logo {
      position: relative;
      margin-bottom: 30px;
      display: inline-block;
    }

    .loading-logo-img {
      width: 120px;
      height: 120px;
      object-fit: contain;
      border-radius: 50%;
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
      animation: logoFloat 2s ease-in-out infinite alternate;
      position: relative;
      z-index: 2;
    }

    .loading-pulse {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 140px;
      height: 140px;
      border: 2px solid var(--loading-accent);
      border-radius: 50%;
      animation: pulse 1.5s ease-in-out infinite;
      opacity: 0.6;
    }

    .loading-text {
      font-size: 1.2rem;
      color: var(--loading-text-color);
      font-weight: 600;
      margin-bottom: 20px;
      animation: textFade 1.5s ease-in-out infinite alternate;
    }

    .loading-bar {
      width: 200px;
      height: 4px;
      background: rgba(139, 69, 19, 0.2);
      border-radius: 2px;
      overflow: hidden;
      margin: 0 auto;
    }

    .loading-progress {
      width: 100%;
      height: 100%;
      background: var(--loading-accent);
      border-radius: 2px;
      animation: progress 0.8s ease-in-out;
      transform: translateX(-100%);
    }

    @keyframes logoFloat {
      0% { transform: translateY(0px) rotate(0deg); }
      100% { transform: translateY(-10px) rotate(5deg); }
    }

    @keyframes pulse {
      0% { transform: translate(-50%, -50%) scale(1); opacity: 0.6; }
      50% { transform: translate(-50%, -50%) scale(1.1); opacity: 0.3; }
      100% { transform: translate(-50%, -50%) scale(1); opacity: 0.6; }
    }

    @keyframes textFade {
      0% { opacity: 0.7; }
      100% { opacity: 1; }
    }

    @keyframes progress {
      0% { transform: translateX(-100%); }
      100% { transform: translateX(0%); }
    }

    .loading {
      opacity: 0;
      transform: translateY(20px);
      transition: all 0.6s ease;
    }

    .loading.loaded {
      opacity: 1;
      transform: translateY(0);
    }

    @media (max-width: 768px) {
      .loading-logo-img {
        width: 100px;
        height: 100px;
      }
      
      .loading-pulse {
        width: 120px;
        height: 120px;
      }
      
      .loading-text {
        font-size: 1.1rem;
      }

      .loading-bar {
        width: 150px;
      }
    }
  `
  document.head.appendChild(style)
}

// Keyboard Navigation
document.addEventListener("keydown", (e) => {
  if (e.key === "Escape") {
    hamburger.classList.remove("active")
    navMenu.classList.remove("active")
    document.body.style.overflow = "auto"
  }

  if (e.code === "Space" && e.target === document.body) {
    e.preventDefault()
    musicToggle.click()
  }

  if (e.key === "Home") {
    e.preventDefault()
    backToTop.click()
  }
})

// Performance Optimization
let ticking = false

function updateScrollElements() {
  if (window.pageYOffset > 300) {
    backToTop.classList.add("visible")
  } else {
    backToTop.classList.remove("visible")
  }
  ticking = false
}

window.addEventListener("scroll", () => {
  if (!ticking) {
    requestAnimationFrame(updateScrollElements)
    ticking = true
  }
})
